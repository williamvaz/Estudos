<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
<meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=0.1, shrink-to-fit=yes">
  <title>Estudos Futebol ‚Ä¢ Palavras</title>
  <link rel="stylesheet" href="home.css">

    <!-- √çcones -->
  <link rel="icon" type="image/webp" href="icone.webp" />
  <link rel="apple-touch-icon" href="icone.webp" />

  <style>
    :root { color-scheme: dark; }
    body { color: #fff; }
    a { color: #fff; text-decoration: underline; }
    .container { max-width: 980px; margin: 0 auto; padding: 12px; }
    .card { background: rgba(0,0,0,.15); border: 1px solid rgba(255,255,255,.08);
            border-radius: 14px; padding: 12px; }
    .topbar .brand { display:flex; align-items:center; gap:10px; padding:12px; }
    .topbar h1 { font-size: 1.25rem; margin:0; }
    .small { font-size:.9rem; opacity:.8; }
    .muted { opacity:.85; }
    .grid { display:grid; gap:12px; }
    .header-row { display:flex; align-items:center; gap:12px; }
    .spacer { flex:1 }
    .input { width: 260px; background:#0f1f15; color:#fff; border:1px solid #284b34; border-radius:10px; padding:10px 12px; }

    /* --- stat cards --- */
    .stats { display:grid; grid-template-columns: repeat(2,minmax(0,1fr)); gap:10px; }
    @media (min-width: 560px) { .stats { grid-template-columns: repeat(4,minmax(0,1fr)); } }
    .stat { display:flex; flex-direction:column; gap:4px; padding:10px 12px;
            border-radius:12px; background:#102618; border:1px solid #284b34; }
    .stat-label { font-size:.85rem; opacity:.8; }
    .stat-value { font-size:1.4rem; font-weight:700; }

    /* -------- tabela responsiva sem scroll horizontal -------- */
    .table-wrap { overflow-x: visible; }

    #words-table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;     /* colunas obedecem as larguras abaixo */
    }
    #words-table th, #words-table td {
      padding: 8px 10px;
      white-space: normal;     /* permite quebrar linhas */
      word-break: break-word;  /* evita estouro em URLs longas */
    }
    /* Larguras (ajuste se quiser) */
    #words-table th:nth-child(1), #words-table td:nth-child(1) { width: 45%; } /* Word */
    #words-table th:nth-child(2), #words-table td:nth-child(2) { width: 25%; } /* Definition */
    #words-table th:nth-child(3), #words-table td:nth-child(3) { width: 30%; } /* Voice */

    #words-table td a {
      display: inline-block;
      max-width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      vertical-align: middle;
    }
    #words-table audio {
      width: 100%;
      max-width: 220px;
      height: 28px;
    }
    @media (max-width: 420px) {
      #words-table th, #words-table td { padding: 6px 8px; }
      #words-table th:nth-child(1), #words-table td:nth-child(1) { width: 42%; }
      #words-table th:nth-child(2), #words-table td:nth-child(2) { width: 16%; }
      #words-table th:nth-child(3), #words-table td:nth-child(3) { width: 22%; }
      #words-table th:nth-child(4), #words-table td:nth-child(4) { width: 20%; }
      #words-table audio { max-width: 180px; }
    }

    .badge { padding:2px 8px; border-radius:999px; border:1px solid rgba(255,255,255,.15); background:rgba(255,255,255,.05); }
    .nowrap { white-space:nowrap; }

    /* ‚Äî‚Äî‚Äî Compacta√ß√£o geral no S23 ‚Äî‚Äî‚Äî */
html { font-size: 15px; }                /* base menor */
@media (max-width: 390px){ html{ font-size:14px; } }

.topbar h1 { font-size: 1.05rem; }       /* t√≠tulo menor */
.stat-value { font-size: 1.15rem; }      /* n√∫meros dos cards menores */
.stat-label { font-size: .8rem; }

/* ‚Äî‚Äî‚Äî Tabela mais compacta e sem corte ‚Äî‚Äî‚Äî */
#words-table { font-size: .95rem; }
#words-table th, #words-table td {
  padding: 6px 8px;            /* menos padding */
  white-space: normal;
  word-break: break-word;
  overflow: visible;           /* evita "comer" os controles de √°udio */
}

/* Rebalanceia larguras p/ dar mais espa√ßo ao √°udio */
#words-table th:nth-child(1), #words-table td:nth-child(1) { width: 45%; } /* Word  */
#words-table th:nth-child(2), #words-table td:nth-child(2) { width: 25%; } /* Definition */
#words-table th:nth-child(3), #words-table td:nth-child(3) { width: 30%; } /* Voice */

/* Link compacto e com retic√™ncias se grande */
#words-table td a {
  display:inline-block; max-width:100%;
  overflow:hidden; text-overflow:ellipsis;
}

/* ‚Äî‚Äî‚Äî √Åudio: tamanho seguro e sempre clic√°vel ‚Äî‚Äî‚Äî */
#words-table audio {
  display:block;
  width: 100%;
  max-width: 180px;   /* antes 220px; reduz pra caber no S23 */
  height: 32px;       /* bot√£o de play mais confort√°vel */
}
@media (min-width: 560px){
  #words-table audio { max-width: 220px; }
}

/* Telas muito estreitas: ainda mais compacto */
@media (max-width: 420px){
  #words-table { font-size: .9rem; }
  #words-table th:nth-child(1), #words-table td:nth-child(1) { width: 44%; }
  #words-table th:nth-child(2), #words-table td:nth-child(2) { width: 14%; }
  #words-table th:nth-child(3), #words-table td:nth-child(3) { width: 18%; }
  #words-table th:nth-child(4), #words-table td:nth-child(4) { width: 24%; }
  #words-table audio { max-width: 160px; }
}

/* ‚Äî‚Äî‚Äî Compacta√ß√£o geral no S23 ‚Äî‚Äî‚Äî */
html { font-size: 15px; }                /* base menor */
@media (max-width: 390px){ html{ font-size:14px; } }

.topbar h1 { font-size: 1.05rem; }       /* t√≠tulo menor */
.stat-value { font-size: 1.15rem; }      /* n√∫meros dos cards menores */
.stat-label { font-size: .8rem; }

/* ‚Äî‚Äî‚Äî Tabela mais compacta e sem corte ‚Äî‚Äî‚Äî */
#words-table { font-size: .95rem; }
#words-table th, #words-table td {
  padding: 6px 8px;            /* menos padding */
  white-space: normal;
  word-break: break-word;
  overflow: visible;           /* evita "comer" os controles de √°udio */
}

/* Rebalanceia larguras p/ dar mais espa√ßo ao √°udio */
#words-table th:nth-child(1), #words-table td:nth-child(1) { width: 45%; } /* Word  */
#words-table th:nth-child(2), #words-table td:nth-child(2) { width: 25%; } /* Definition */
#words-table th:nth-child(3), #words-table td:nth-child(3) { width: 30%; } /* Voice */

/* Link compacto e com retic√™ncias se grande */
#words-table td a {
  display:inline-block; max-width:100%;
  overflow:hidden; text-overflow:ellipsis;
}

/* ‚Äî‚Äî‚Äî √Åudio: tamanho seguro e sempre clic√°vel ‚Äî‚Äî‚Äî */
#words-table audio {
  display:block;
  width: 100%;
  max-width: 180px;   /* antes 220px; reduz pra caber no S23 */
  height: 32px;       /* bot√£o de play mais confort√°vel */
}
@media (min-width: 560px){
  #words-table audio { max-width: 220px; }
}

/* Telas muito estreitas: ainda mais compacto */
@media (max-width: 420px){
  #words-table { font-size: .9rem; }
  #words-table th:nth-child(1), #words-table td:nth-child(1) { width: 44%; }
  #words-table th:nth-child(2), #words-table td:nth-child(2) { width: 14%; }
  #words-table th:nth-child(3), #words-table td:nth-child(3) { width: 18%; }
  #words-table th:nth-child(4), #words-table td:nth-child(4) { width: 24%; }
  #words-table audio { max-width: 160px; }
}


  </style>
</head>
<body class="is-mobile">
  <header class="topbar">
    <div class="brand card">
      <span style="font-size:20px">üìö</span>
      <h1>Lista de Palavras</h1>
      <a class="small" href="index.html" style="margin-left:auto">‚Üê In√≠cio</a>
    </div>
  </header>

  <main class="container grid">
    <!-- filtros -->
    <section class="card">
      <h2 style="margin:0 0 8px">Banco de palavras</h2>
      <div class="header-row" style="margin-top:8px">
        <input id="search" class="input" type="search" placeholder="Buscar palavra (ex.: house)" />
        <div class="spacer"></div>
        <span class="small muted">Mostrando apenas palavras com n√≠vel ‚â• 1</span>
      </div>
    </section>

    <!-- stats -->
    <section class="stats">
      <div class="stat">
        <div class="stat-label">Palavras em n√≠vel ‚â• 1</div>
        <div class="stat-value" id="stat-total-1plus">0</div>
      </div>
      <!-- espa√ßo pra futuros cards -->
      <div class="stat">
        <div class="stat-label">Palavras em n√≠vel ‚â• 4</div>
        <div class="stat-value" id="stat-total-4plus">0</div>
      </div>
      <div class="stat">
        <div class="stat-label">Palavras em n√≠vel ‚â• 7</div>
        <div class="stat-value" id="stat-total-7plus">0</div>
      </div>
      <div class="stat">
        <div class="stat-label">Palavras em n√≠vel ‚â• 10</div>
        <div class="stat-value" id="stat-total-10plus">0</div>
      </div>
    </section>

    <!-- tabela -->
    <section class="card table-wrap">
      <table id="words-table">
        <thead>
          <tr>
            <th>Word</th>
            <th class="right">Level</th>
            <th>Definition</th>
            <th>Voice</th>
          </tr>
        </thead>
        <tbody id="tb"></tbody>
      </table>
    </section>
  </main>

<script>
  // --------- config ----------
  const LKEY = 'words_info'; // { [word]: { ...campos abaixo } }

  // --------- storage helpers ----------
  const loadStore = () => {
    try { return JSON.parse(localStorage.getItem(LKEY) || '{}'); }
    catch { return {}; }
  };
  const saveStore = (db) => localStorage.setItem(LKEY, JSON.stringify(db));

  // --------- normaliza√ß√£o ----------
  function normalizeWords(raw) {
    return (raw || [])
      .map(w => ({
        word: String(w.word || '').trim(),
        level: Number(w.level ?? 1),
        pos: w.pos || '',
        definition_url: w.definition_url || '',
        voice_url: w.voice_url || ''
      }))
      .filter(w => w.word);
  }

  // Cria/atualiza o registro no localStorage com os campos solicitados
  function ensureEntry(db, w) {
    if (!db[w.word]) {
      db[w.word] = {
        word: w.word,
        level: Number(w.level ?? 1),
        pos: w.pos || '',
        definition_url: w.definition_url || '',
        voice_url: w.voice_url || '',
        "Memoria": 0,
        "Proxima revis√£o": 100000
      };
    } else {
      // Mant√©m sincronizados os campos vindos do words.json (sem mexer na Memoria/Proxima revis√£o)
      db[w.word].word = w.word;
      if (w.level != null) db[w.word].level = Number(w.level);
      if (w.pos != null) db[w.word].pos = w.pos;
      if (w.definition_url != null) db[w.word].definition_url = w.definition_url;
      if (w.voice_url != null) db[w.word].voice_url = w.voice_url;
    }
  }

  // --------- estado ---------
  let DB = {};      // mapa salvo no localStorage
  let WORDS = [];   // words.json normalizado (s√≥ pra render)

  // --------- UI ---------
  function renderCount() {
    const n = Object.values(DB).filter(x => Number(x.level || 0) >= 1).length;
    const el = document.getElementById('stat-total-1plus');
    if (el) el.textContent = String(n);
  }

  function renderTable(filterText = '') {
    const q = (filterText || '').trim().toLowerCase();
    const tbody = document.getElementById('tb');
    if (!tbody) return;

    const rows = Object.values(DB)
      .filter(item => Number(item.level || 0) >= 1)
      .filter(item => !q || item.word.toLowerCase().includes(q))
      .sort((a, b) => a.word.localeCompare(b.word))
      .map(item => {
        const def = item.definition_url ? `<a href="${item.definition_url}" target="_blank" rel="noopener">abrir</a>` : '';
        const voc = item.voice_url ? `<audio controls preload="none"><source src="${item.voice_url}"></audio>` : '';
        return `<tr>
          <td class="nowrap">${item.word}</td>
          <td class="right"><span class="badge">L${item.level ?? 0}</span></td>
          <td>${def}</td>
          <td>${voc}</td>
        </tr>`;
      }).join('');

    tbody.innerHTML = rows || `<tr><td colspan="4" class="muted">Nenhuma palavra no n√≠vel 1+ ainda.</td></tr>`;
  }

  // --------- boot ---------
  (async function init() {
    try {
      const res = await fetch('words.json', { cache: 'no-store' });
      WORDS = res.ok ? normalizeWords(await res.json()) : [];
    } catch (e) {
      console.warn('Falha ao carregar words.json', e);
      WORDS = [];
    }

    // carrega o que j√° havia e garante as entradas m√≠nimas
    DB = loadStore();
    WORDS.forEach(w => ensureEntry(DB, w));
    saveStore(DB); // persiste ap√≥s normalizar

    // render
    renderCount();
    renderTable();

    // busca
    const search = document.getElementById('search');
    if (search) {
      search.addEventListener('input', (e) => renderTable(e.target.value));
    }
  })();
</script>

</body>
</html>
